(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return __webpack_require__(15563)}])},15563:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return pages}});var jsx_runtime=__webpack_require__(85893);__webpack_require__(17793);var react=__webpack_require__(67294),three_module=__webpack_require__(99477),GLTFLoader=__webpack_require__(77836),GLTFExporter=__webpack_require__(94878);let AvatarIframe=param=>{let{userName,setRpmFrame,setReadyPlayerUrl}=param,frame=(0,react.useRef)(null),[value,setValue]=(0,react.useState)(""),saveGlbAvatar=async glbURL=>{};async function updateValues(){await localStorage.setItem("avatarUrl",value),setReadyPlayerUrl(value),await localStorage.setItem("metaverseLink","https://icc.streetverse.world/8iaQk64/surprised-informal-gala?name=ICCPlayer&avatarUrl="+value.split("/")[3].split(".")[0]),setRpmFrame(!1)}return(0,react.useEffect)(()=>{var ref;if(null!==frame.current&&void 0!==frame.current)return null===(ref=frame.current)||void 0===ref||ref.setAttribute("src","https://".concat("fullbody",".readyplayer.me/avatar?clearCache&frameApi&quality=low")),window.addEventListener("message",subscribe),document.addEventListener("message",subscribe),()=>{window.removeEventListener("message",subscribe),document.removeEventListener("message",subscribe)};function subscribe(event){let json=function(event){try{return JSON.parse(event.data)}catch(error){return null}}(event);if((null==json?void 0:json.source)==="readyplayerme"){if("v1.frame.ready"===json.eventName){var ref,ref1;null===(ref=frame.current)||void 0===ref||null===(ref1=ref.contentWindow)||void 0===ref1||ref1.postMessage(JSON.stringify({target:"readyplayerme",type:"subscribe",eventName:"v1.**"}),"*"),console.log("Frame is ready")}"v1.avatar.exported"===json.eventName&&(setValue(json.data.url),console.log(json.data.url),saveGlbAvatar(json.data.url)),"v1.user.set"===json.eventName&&console.log("User with id ".concat(json.data.id," set: ").concat(JSON.stringify(json)))}}},[]),(0,react.useEffect)(()=>{null!=value&&""!==value&&updateValues()},[value]),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("button",{onClick:()=>setRpmFrame(!1),className:"fixed bottom-2 left-4 z-40 cursor-pointer rounded-[10px] bg-[#e34030] px-8 py-4 text-white",children:"Cancel"}),(0,jsx_runtime.jsx)("div",{className:""==value?"fixed top-[2%] left-[2%] z-40 h-[90%] w-[96%] rounded-2xl shadow-xl  ":"",children:(0,jsx_runtime.jsx)("iframe",{width:"100%",height:"100%",ref:frame,id:"frame",className:"frame",allow:"camera *; microphone *; clipboard-write"})})]})};var App_module=__webpack_require__(62963),App_module_default=__webpack_require__.n(App_module),browser=__webpack_require__(98690),browser_default=__webpack_require__.n(browser);let S3_BUCKET="demobucket-graphity";browser_default().config.update({accessKeyId:"AKIA5VBJLFVQBRCUGB4S",secretAccessKey:"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"});let myBucket=new(browser_default()).S3({params:{Bucket:S3_BUCKET},region:"us-east-1"}),animations={Idle:"/animations/idle.glb",Walking:"/animations/walk.glb",WalkingBackwards:"/animations/walkBack.glb",LeftStrafeWalk:"/animations/walkLeft.glb",RightStrafeWalk:"/animations/walkRight.glb",Running:"/animations/run.glb",RunningBackward:"/animations/runBack.glb",LeftStrafe:"/animations/runLeft.glb",RightStrafe:"/animations/runRight.glb",Flying:"/animations/fly.glb",Dancing:"/animations/rumba-dancing2.glb"};function GlbCombiner(){let[isFromFile,setIsFromFile]=(0,react.useState)(!0),[modelPath,setModelPath]=(0,react.useState)("https://models.readyplayer.me/63fa5c5196cb00e4ba3674d6.glb"),[isFrameOpen,setIsFrameOpen]=(0,react.useState)(!1),[file,setFile]=(0,react.useState)(null),[progress,setProgress]=(0,react.useState)(0),[loaderText,setLoaderText]=(0,react.useState)("Loading..."),[isLoading,setIsLoading]=(0,react.useState)(!1);(0,react.useEffect)(()=>{(file||void 0!=file)&&uploadFile(file)},[file]);let uploadFile=file=>{let params={ACL:"public-read",Body:file,Bucket:S3_BUCKET,Key:modelPath.split("me/")[1]};myBucket.putObject(params).on("httpUploadProgress",evt=>{setProgress(Math.round(evt.loaded/evt.total*100))}).send(err=>{err&&console.log(err)})};async function goToMetaverse(){console.log("going to metaverse"),setIsLoading(!0);let index=0,messages=["Creating NFTs...","Preparing Stadium...","Positioning Players...","Setting up the Match...","All Set...","Enjoy the Match!"],intervalId=setInterval(()=>{if(setLoaderText(messages[index]),setIsLoading(5!=++index),5==index){clearInterval(intervalId);return}},2500)}return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)("div",{className:App_module_default().app,children:(0,jsx_runtime.jsxs)("div",{className:App_module_default().container,children:[(0,jsx_runtime.jsxs)("div",{className:App_module_default().heading,children:[(0,jsx_runtime.jsx)("h1",{children:"Metaverse Profile Creator"}),(0,jsx_runtime.jsx)("p",{className:App_module_default().subHeading,children:"For ICC NUIM"})]}),(0,jsx_runtime.jsxs)("div",{className:App_module_default().body,children:[(0,jsx_runtime.jsxs)("div",{className:App_module_default().buttonGroup,children:[(0,jsx_runtime.jsx)("div",{onClick:()=>setIsFromFile(!0),className:App_module_default().homeButton+" "+(isFromFile?App_module_default().isHomeActive:""),children:"RPM"}),(0,jsx_runtime.jsx)("div",{onClick:()=>setIsFromFile(!1),className:App_module_default().homeButton+" "+(isFromFile?"":App_module_default().isHomeActive),children:"URL"})]}),(0,jsx_runtime.jsx)("div",{className:App_module_default().formContainer,children:isFromFile?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("button",{className:App_module_default().homeButton,onClick:()=>setIsFrameOpen(!0),type:"button",children:"Choose Avatar"}),(0,jsx_runtime.jsx)("input",{className:App_module_default().inputBox,type:"url",value:modelPath,onChange:e=>setModelPath(e.target.value),name:"readyPlayerMe",placeholder:"Enter Ready Player Me URL"}),isFrameOpen&&(0,jsx_runtime.jsx)(AvatarIframe,{userName:"Hello",setRpmFrame:setIsFrameOpen,setReadyPlayerUrl:setModelPath})]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{})}),(0,jsx_runtime.jsx)("div",{className:App_module_default().checkboxContainer}),isLoading?(0,jsx_runtime.jsxs)("div",{className:"flex flex-col justify-center items-center h-screen w-screen z-30 absolute top-0 left-0 bg-blue-800 overflow-hidden",children:[(0,jsx_runtime.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"}),(0,jsx_runtime.jsx)("div",{className:"py-4 text-white font-bold text-4xl",children:loaderText})]}):null,100!==progress?(0,jsx_runtime.jsx)("a",{className:App_module_default().homeButton,target:"_blank",rel:"noreferrer",href:"https://icc.streetverse.world/8iaQk64/surprised-informal-gala?avatarUrl="+modelPath.split("me/")[1].split(".glb")[0],children:"Open Metaverse"}):(0,jsx_runtime.jsx)("div",{className:"hidden",onClick(){goToMetaverse(),combineAnimations(modelPath,setFile).catch(console.error)},children:"Confirm Avatar"})]})]})})})}async function combineAnimations(modelPathName,setFile){let gltfLoader=new GLTFLoader.E,gltfExporter=new GLTFExporter.M,group=new three_module.ZAu;group.name="Armature";let gltf=await asyncGltfLoad(gltfLoader,modelPathName);group.add(gltf.scene),await loadAnimations(group,animations),gltfExporter.parse(gltf.scene,glb=>(function(arrayBuffer,fileName,setFile){let blob=new Blob([arrayBuffer],{type:"application/octet-stream"});setFile(blob),console.log(fileName)})(glb,modelPathName,setFile),console.error,{binary:!0,animations:group.animations})}async function loadAnimations(group,animations){let gltfLoader=new GLTFLoader.E;for(let[name,path]of Object.entries(animations)){let gltf=await asyncGltfLoad(gltfLoader,path);gltf.animations[0].name=name,group.animations.push(gltf.animations[0]),console.log(gltf.animations[0])}}async function asyncGltfLoad(gltfLoader,path){return await new Promise((resolve,reject)=>{gltfLoader.load(path,resolve,void 0,reject)})}let HomePage=()=>(0,jsx_runtime.jsx)(GlbCombiner,{});var pages=HomePage},62963:function(module){module.exports={app:"App_app__RCrYt",body:"App_body__LvHx0",container:"App_container__lu6QK",heading:"App_heading__MTPSr",subHeading:"App_subHeading__GWu4e",buttonGroup:"App_buttonGroup__wj3KU",homeButton:"App_homeButton__Zst6w",isHomeActive:"App_isHomeActive__qpJZg",formContainer:"App_formContainer__2WlpS",inputBox:"App_inputBox__Hs_wV",checkboxContainer:"App_checkboxContainer__Mpch5",checkbox:"App_checkbox__8g6zN",checkboxElement:"App_checkboxElement__AQyRJ",checkboxTitle:"App_checkboxTitle__86Cns"}},28022:function(){}},function(__webpack_require__){__webpack_require__.O(0,[586,737,605,774,888,179],function(){return __webpack_require__(__webpack_require__.s=48312)}),_N_E=__webpack_require__.O()}]);